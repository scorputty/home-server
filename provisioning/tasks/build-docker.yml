---
- set_fact: compose_dir=/opt/ansible-docker

- file:
    path: "{{ compose_dir }}"
    state: directory

- name: create shared config directories
  file:
    path: "{{ docker_config_dir }}/{{ item }}"
    state: directory
  with_items:
    - sabnzbd
    - couchpotato

- name: create shared data directories
  file:
    path: "{{ docker_data_dir }}/{{ item }}"
    state: directory
  with_items:
    - Movies
    - TVshows
    - Music


- name: upload docker files
  synchronize:
    src: "{{ item }}"
    dest: "{{ compose_dir }}"
  with_items:
    - docker-compose.yml
    - sabnzbd
    - couchpotato

- name: start docker-compose couchpotato
  docker_service:
    project_name: couchpotato
    project_src: "{{ compose_dir }}/couchpotato"
  register: output

- debug: var=output

- name: start docker-compose sabnzbd
  docker_service:
    project_name: sabnzbd
    project_src: "{{ compose_dir }}/sabnzbd"
  register: output

- debug: var=output
