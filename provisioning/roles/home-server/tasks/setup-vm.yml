---
- name: add epel repository
  yum: name=epel-release state=latest
  when: ansible_distribution == "CentOS"

- name: create /etc/yum.repos.d/docker.repo
  template: src=templates/docker.repo.j2 dest=/etc/yum.repos.d/docker.repo

- name: install basic packages
  action: >
    {{ ansible_pkg_mgr }} name={{ item }} state=latest update_cache=yes
  with_items:
    - nfs-utils
    - rsync
    - htop
    - vim
    - python-pip
    - docker-engine
    - lsof

- name: add vagrant user to docker
  user:
    name: vagrant
    groups: docker
    append: yes

- name: install with python-pip packages
  pip:
    name: "{{ item }}"
    state: latest
  with_items:
    - PyYAML
    - python-consul
    - docker-compose
    - docker-py

- name: force upgrade docker-compose
  command: pip install --upgrade docker-compose
